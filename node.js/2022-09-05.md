# Node.js 시작하기

- 참고서적 : Node.js 교과서

- 저자 깃허브 페이지 : [http://github.com/zerocho](https://github.com/zerocho)



# 핵심 개념 이해하기

- 노드 공식사이트에서 노드는 Chrome V8 Javascript 엔진으로 빌드된 Javascript 런타임 이다.

  - 노드의 이미지로 알려져 있는 서버를 실행하는 용도 외에도 노드는 자바스크립트 프로그램을 실행하는 런타임으로서 사용하는 방법도 존재한다.

    

## 서버

- 노드를 이용해 자바스크립트 애플리케이션을 실행할 수 있지만, 노드는 서버 어플리케이션을 실행하는데 제일 많이 사용된다

- 여기서 서버란, 네트워크를 통해 클라이언트에 정보나 서비스를 제공하는 컴퓨터, 프로그램을 말한다

  

## 자바스크립트 런타임

- 노드는 언어가 아닌 자바스크립트 런타임 이다.
- 여기서 런타임은 특정 언어로 만든 프로그램들을 컴퓨터에서 실행할 수 있게 해주는 역할을 한다
- 따라서 노드를 배우기전 자바스크립트를 모른다면 사용할 수 없을 것이다.



### 이벤트 기반

- 이벤트 기반은 이벤트가 발생할때 미리 지정해둔 작업을 수행하는 방식입니다.

- 예시로 클릭 이벤트, 네트워크 요청등이 있습니다.

- 이벤트 기반 모델에서는 이벤트 루프 라는 개념이 등장합니다.

  - 스택 형식의 예제

  ```jsx
  function first(){
  	second();
  	console.log('1 번');
  }
  
  function second(){
  	third();
  	console.log("2 번");
  }
  
  function third(){
  	first();
  	console.log("3 번");
  }
  
  first();
  ```

  - 위와 같이 자바스크립트가 작성되어 있을때 이벤트 루프는 가장 윗줄부터 한줄씩 실행하면서, 함수 호출부분을 호출 스택에 넣는 식으로 작동됩니다.

  - 함수가 호출되면 스택에 쌓이기 때문에

    - first(), second(), third() 순서로 쌓이며

  - 스택구조상 마지막에 쌓인 함수부터 실행하기 때문에

    - third(), second(), first() 순으로 실행된다

    

  - 타임아웃의 예제

  ```jsx
  function run(){
  	console.log('3초 후 시작');
  }
  console.log('시작');
  settimeout(run, 3000);
  console.log('끝');
  ```

  - 이것의 결과는 시작, 끝, 3초 후 실행 이라는 결과가 나오겠지만, 호출 스택으로 설명하기는 어렵다.
    - settimeout 함수의 콜백인 run 함수가 언제 호출 스택에 들어가는지 쉽게 파악하기 어렵기 때문이다.

  

- 이벤트 루프 : 이벤트 발생 시 호출할 콜백 함수들을 관리, 호출된 콜백 함수의 실행 순서를 결정하는 역할을 담당. 노드가 종료될 때 까지 이벤트 처리 작업을 반복하므로 루프라고 부른다.

- 백그라운드 : settimeout 과 같은 타이머나 이벤트 리스너들이 대기하는 곳, 자바스크립트가 아닌 다른언어로 작성된 언어라 봐도 된다. 여러 작업이 동시에 실행될 수 있습니다.

- 테스크 큐 : 이벤트 발생 후, 백그라운드에서는 테스트 큐로 타이머나 이벤트 리스너의 콜백 함수를 보냄, 정해진 순서대로 콜백들이 줄을 서 있으므로 콜백 큐 라고도 불린다.

- 이벤트 루프 요약

  1. 호출스택에 함수 스택
  2. settimeout 등의 함수 호출 시, 콜백함수는 백그라운드에 보냄
  3. 백그라운드에서 settimeout에 설정한 시간만큼 지남
  4. 테스크 큐에 콜백함수 보냄
  5. 호출스택에서 모든 함수 호출이 끝남
  6. 테스크 큐에 있는 함수를 호출 스택에 보냄
  7. 이벤트 루프는 테스크 큐에 콜백이 들어올때 까지 대기

  

  - 여기서 콜백함수에 대기중인 함수가 많을경우 테스크 큐에 들어간 settimeout의 콜백함수는 3초가 지난 후에도 실행이 안될 수 있다.



## 논 블로킹 I/O

- 이벤트 루프를 잘 활용하면 오래 걸리는 작업을 효율적으로 처리가 가능
- 작업에는 크게 두가지 작업이 존재
  - 동시에 실행될 수 있는 작업
  - 동시에 실행될 수 없는 작업

```jsx
fuction longRunningTask(){
	console.log('작업 끝');
}

console.log('시작');
longRunningTask();
console.log('다음 작업')
```

- 위와 같은 경우 다음작업은 longRunningTask() 의 작업이 끝날때 까지 대기하는 상황이 발생한다

```jsx
fuction longRunningTask(){
	console.log('작업 끝');
}

console.log('시작');
settimeout(longRunningTask, 0);
console.log('다음 작업')
```

- 여기서 settimeout을 사용하여 오래걸리는 I/O 작업등을 백그라운드에 넘겨 동시에 처리할 수 있다.
- 다만 이것은 실행 순서만 바꾸는 방식으로 느린 작업을 백그라운드로 넘겨 빠른 작업 이후에 처리하는 것이다.



### 싱글 스레드

- 싱글 스레드는 스레드가 하나뿐임을 의미
- 우리가 작성한 코드는 노드에서 싱글 스레드 형식으로 작동
- 자세한 스레드의 개념은 운영체제 문서를 참고



# 서버로서의 노드

- 노드에서 우리가 작성한 코드는 싱글 스레드에서 실행 되기 때문에 CPU자원을 많이 요구하는 용도로는 다른언어에 비해 부적합 하다 볼 수 있다.
- 때문에 I/O 작업이 많은, 주식차트, 실시간 채팅등에 적합하다.



# 서버외의 노드

- 처음에는 노드를 서버용으로 많이 사용했지만, 자바스크립트의 런타임이므로 용도가 서버에 한정되지 않게 되었다.
- 사용범위가 점점늘어나면서 웹, 모바일, 데스크톱 어플리케이션 개발에도 사용되기 시작하였다.
- 노드 기반의 대표적 웹 프레임워크로는 리액트, 앵귤러, 뷰 등이 있다.
  - ex) 페이스북, 인스타, 핀터레스트 등
- 데스크톱 개발 도구로는 일렉트론이 대표적이다.
  - ex) 아톰, 슬랙, 디스코드



# 개발환경 설정하기



## 윈도우

- 추후 작성



## 리눅스

- 추후 작성



## 맥

- 카탈리나(10.15) 기준

1. https://nodejs.org/ko/ (node js 설치)
2. 터미널에 node -v 명령어를 이용해 노드 버전 확인
3. npm -v 명령어를 이용해 npm 버전 확인



## 비주얼 스튜디오 코드 설치/ 환경설정

- 각 환경에 맞게 비주얼 스튜디오 코드를 설치한다
- 리눅스에 경우 대부분 CLI 형식으로 작성하기 때문에 vim 등의 에디터를 추천