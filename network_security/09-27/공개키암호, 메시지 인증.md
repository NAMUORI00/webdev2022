# 공개키암호, 메시지 인증

- 메시지 인증 방법
- 안전해시함수
- 메시지 인증 코드
- 공개키 암호 원리
- 공개키 암호 알고리즘
- 디지털 서명



## 공캐키 암호와 메시지 전송



### 메시지 인증 방법

- 암호를 사용하면 passive attack(소극적 공격)을 막을 수 있으나 active attack(적극적 공격)을 방어 하기 위해선 다른 방법이 필요

→ 메시지 인증의 탄생

- 메시지 인증의 두가지 측명
    - 근원지 인증
    - 메시지 인증



### 관용 암호를 이용한 인증

- 송신자 수신자가 동일한 키를 가지고 있다고 가정하여 인증을 진행
- 오직 진짜 송신자만이 수신자에게 보내는 메세지를 성공적으로 암호화 할 수 있다
    - 메시지 변경 탐지
    - 대칭 암호만 가지고는 데이터 인증에 부적합
        - ECB를 예로 들때 암호문 블록의 순서만 바꿔도 각 블록은 개별적으로 복호화가 잘되나, 순서가 바뀌어 데이터 내용이 뒤바뀌게 된다.
- ex) 메시지에 타임스탬프를 포함



### 메시지 암호화 없이 메시지 인증

- 인증 꼬리표 방식
    - 메시지 꼬리부분에 태그를 붙여서 보내는 방식, 메시지 자체는 암호화 하지 않아 기밀성이 보장되지 않음
- 메지 암호 없는 메시지 인증이 적합한 경우
    - 브로드캐스팅 : 네트워크 경고
    - 메시지 복호화 시간이 부족한 경우(테스트환경)
    - 컴퓨터 프로그램을 평문인 채로 인증할 경우, 필요할 때만 무결성을 인증을 필요로 할 경우



### 메시지 인증코드(MAC)

- MAC(Message Authentication Code)
    - 메시지에 붙여지는 작은 데이터 블록을 생성하기 위해 비밀키를 이용하는 방법
- MAC - F(K, M)
    - M : 메시지
    - F : 인증코드 함수
    - K : A와 B 의 공유키
- 효과
    - 수신자는 메시지가 변경되지 않았다는 무결성 확인 가능
    - 수신자는 메시지가 송신자라 주장하는 근원지로 송신되었음을 확인가능
    - 메시지가 정확한 순서임을 확인이 가능



### 일방향 해시 함수

- 메시지 인증 코드와 유사하게 임의 크기의 메시지 M을 입력으로 받아 들여 일정한 크기의 메시지 다이제스트(Message Diagest)를 출력하는 함수
- MAC 과는 다르게 비밀 키를 입력을 받지 않고 동작함
- 해시 = H(M)
    - H : 해시함수
    - M : 메시지

- 암호화 없는 메시지 인증이 존재하고 개발되는 이유
    - 암호화를 처리하면 시간이 걸림
    - 고가의 암호화 장비
    - 암호 장비는 대용량 데이터 처리에 적합
    - 암호 알고리즘이 법적으로 수출이 금지되어 있음



### 안전 해시 함수(Secure Hash Functions)

- 해시함수 용도
    - 메시지 인증
    - 디지털 서명
- 파일 메시지 등의 무결성 체크
- 해시 함수의 조건
    - 임의 크기의 데이터 블록에 적용
    - 일정한 길이의 출력
    - 계산이 용이해야 함
    - 같은 값을 출력하는 다른 인수가 없어야함
    - 해시의 결과값으로 인수를 찾을 수 없어야함
        - 약한 충돌지향성
        - 강한 충돌지향성



### 해시 함수의 보안

- 대칭 암호와 마찬가지로 안전 해시 함수에 대한 두가지 공격 방법이 존재
    - 전수공격
    - 생일문제 공격
- 일반적인 안전 해시 함수의 요구조건
    - 프리이미지 저항성 : 2^n
    - 2차 프리이미지 저항성 : 2^n
    - 충돌 저항성 : 2^(n/2)



### 단순 해시 함수

- 가장 가단한 형태의 해시 함수
    - 각 블록에 비트별 xor 연산으로 생성
    - Ci = b1 xor b2 xor b3 xor …. bim
        - C : 해시 코드의 i 번쨰 비트
        - m = 입력의 n 비트 블록의 수
        - bij = j 번째 블록이 i 번째 비트
        - xor = xor 연산



### SHA 안전 해시 함수

- 최근들어 가장 많이 사용하는 안전 해시 알고리즘(Secure Hash Algorithm)
- SHA 함수 종류별 비교

| 길이 단위 : 비트 | SHA-1 | SHA-224 | SHA-256 | SHA-384 | SHA-512 |
| --- | --- | --- | --- | --- | --- |
| 메시지 다이제스트길이 | 160 | 224 | 256 | 384 | 512 |
| 메시지 길이 | < 2^64 | < 2^64 | < 2^64 | < 2^128 | < 2^128 |
| 블록 길이 | 512 | 512 | 512 | 1024 | 1024 |
| 단어 길이 | 32 | 32 | 32 | 64 | 64 |
| 단계 수 | 80 | 64 | 64 | 80 | 80 |



### SHA-3

- SHA-2 중에서 512비트 버전은 우수하다 평가 받지만 이전 SHA 세대와 동일한 구조를 가지고 있어서 우려가 있었다.
- 때문에 NSIT에서는 2007년 차세대 SHA-3 를 공모하게 되었다.
    - SHA-2를 단순히 SHA-3 로 교환만해도 작동이 가능해야함 → 결과적으로 해시 출력값은 224, 256, 384, 512 중에 하나이다
    - 기존 SHA-2 가 가지고 있던 온라인 특성을 보존해야함