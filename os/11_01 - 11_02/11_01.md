# CPU 스케줄링

1. 스케줄링의 개요
2. 스케줄링 시 고려 사항
3. 다중 큐
4. 스케줄링 알고리즘
5. 인터럽트 처리



## CPU, 스케줄링



### CPU 스케줄러

---

- 운영체제에게 식당관리자 처럼 업무 배분을 담당
- 프로세스의 상황을 고려하여 CPU와 시스템 자원을 배정할지 결정하는일을 담당

<img src="11-01\스크린샷_2022-03-28_오후_5.23.54.png" alt="스크린샷_2022-03-28_오후_5.23.54" style="zoom:33%;" />

- 고수준 스케줄링(long term scheduling)
    - 시스템 내의 전체 작업 수를 조절하는 것
    - 어떤 작업을 시스템이 받아들일지 또는 거부할지를 결정
    - 시스템 내에서 동시에 실행 가능한 프로세스의 중개수가 정해짐
    - 장기 스케줄링, 작업 스케줄링, 승인 스케줄링 이라고도 함

- 저수준 스케줄링(short term scheduling)
    - 어떤 프로세스에 CPU를 할당할지, 어떤 프로세스를 대기 상태로 보낼지 등을 결정
    - 아주 짧은 시간에 일어나기 때문에 단기 스케줄링 이라고도 함

- 중간 수준 스케줄링
    - 중지와 활성화로 전체 시스템의 활성화된 프로세스 수를 조절하여 과부하를 막음
    - 일부 프로세스를 중지 상태로 옮김으로 나머지 프로세스가 원만하게 작동하도록 지원
    - 저수준 스케줄링이 원만하게 이루어지도록 완충하는 역할



### CPU 스케줄링 목적

- 공평성
    - 모든 프로세스가 자원을 공평하게 배정받아야함, 특정 프로세스가 배제되어선 안됨
- 효율성
    - 시스템 자원이 유휴 시간 없이 사용되도록 스케줄링 하고 유휴 자원을 사용하는 프로세스에는 우선권을 주어야함
- 안정성
    - 우선순위를 사용하여 중요 프로세스가 먼저 작동하도록 배정함으로, 시스템 자원을 점유하거나 파괴하려는 프로세스로 부터 자원을 보호해야함
- 확장성
    - 프로세스가 증가해도 시스템이 안정적으로 작동하도록 조치해야 함. 시스템 자원이 늘어나는 경우 이 혜택이 시스템에 반영되게 해야함
- 반응 시간 보장
    - 응답이 없는 경우 사용자는 시스템이 멈춘 것으로 가정하기 때문에 시스템은 적절한 시간안에 프로세스의 요구에 반응해야함
- 무한 연기 방지
    - 특정 프로세스의 작업이 무한이 연기되어서는 안된다.
    



### 스케줄링 시 고려 사항

- 선점형 스케줄링
    - 어떤 프로세스가 CPU를 할당받아 실행 중이여도 운영체제가 CPU를 강제로 빼앗을 수 있는 스케줄링 방식
    - 장점
        - 특정 프로세스가 CPU를 독점할 수 없다
        
        → 대화형이나 시분할 시스템에 적합
        
    - 단점
        - 문맥 교환의 오버헤드가 많다
- 비 선점형 스케줄링
    - 어떤 프로세스가 CPU를 점유하면 다른 프로세스가 이를 빼앗을 수 없는 스케줄링 방식
    - 장점
        - CPU 스케줄러의 작업량이 적고 문맥교환의 오버헤드가 적다
        
        → 일괄 작업 시스템에 사용함 (프린터)
        
    - 단점
        - 기다리는 프로세스가 많아 처리율이 떨어짐



### 프로세스 우선순위

- 커널 프로세스의 우선순위가 일반 프로세스보다 높다
- 시스템에는 다양한 우선순위의 프로세스가 공존하며 우선순위가 높은 프로세스가 CPU를 먼저 더 오래 차지
- 시스템에 따라 높은 숫자가 높은 우선순위를 나타내기도하고, 낮은 숫자가 높은 우선순위를 나타내기도함



### CPU 집중프로세스와 입출력 집중 프로세스

- CPU 집중 프로세스 (CPU BURST)
    - 수학 연산과 같이 CPU를 많이 사용하는 프로세스로 CPU 버스트가 많은 프로세스
- 입출력 집중 프로세스 (IO BURST)
    - 저장장치에서 데이터를 복사하는 일과 같이 입출력을 많이 사용하는 프로세스로 입출력 버스가 많은 프로세스

<img src="11-01\스크린샷_2022-03-28_오후_5.50.47.png" alt="스크린샷_2022-03-28_오후_5.50.47" style="zoom:33%;" />

<aside>
💡 입출력 집중 프로세스를 우선하여 처리하는게 대체적인 상황에선 효율적으로 대기시간을 줄일 수 있다.



- 전면 프로세스
    - GUI를 사용하는 운영체제에서 화면의 맨 앞에서 놓인 프로세스
    - 입출력 사용, 상호 작용 프로세스
- 후면 프로세스
    - 사용자와 상호작용이 없는 프로세스
    - 일괄작업 프로세스

→ 우선순위로는 전면 프로세스가 후면프로세스보다 더 우선된다



### 다중 큐

---

<img src="11-01\스크린샷_2022-03-30_오전_11.07.39.png" alt="스크린샷_2022-03-30_오전_11.07.39" style="zoom:33%;" />

- 프로세스의 중요도는 PCB에 표시되지만, 매번 CPU 스케줄러가 모든 PCB를 탐색하는건 비효율 적이기 때문에 다중큐 방식을 사용한다.

- 준비 상태의 다중 큐 (우선순위 순서)
    - 프로세스는 준비 상태의 들어올 때마다 자신의 우선순위에 해당하는 큐의 마지막에 삽입
    - CPU 스케줄러는 우선순위가 가장 높은 큐(0번 큐)의 맨 앞에 있는 프로세스 6에 CPU 할당

- 프로세스의 우선 순위를 배정하는 방석
    - 고정 우선순위 방식
        - 운양체제가 프로세스에 우선순위를 부여하면 프로세스가 끝날 때까지 바뀌지 않는 방식
            - 우선순위가 작업중에 변하지 않기 때문에, 시스템의 변화에 대응이 어려워 효율이 상대적으로 떨어짐
    - 변동 우선순위 방식
        - 프로세스 생성 시 부여받은 우선순위가 프로세스 작업 중간에 변하는 방식
            - 구현하기 어려우나, 시스템의 효율성을 높일 수 있음

- 대기 상태의 다중 큐
  
    ![스크린샷_2022-03-30_오전_11.14.18](11-01\스크린샷_2022-03-30_오전_11.14.18.png)
    
    - 시스템의 효율을 높이기 위해 대기 상태에서는 같은 입출력을 요구한 프로세스들끼리 모아놓음
    
     → 대기 상태의 프로세스들을 구분해 놓는 것으로 다음 작업시 효율을 높일 수 있음
    
- 다중 큐 비교
    - 준비 상태의 다중큐
        - 힌번에 프로세스를 한개를 꺼내어 CPU를 할당
    - 대기 상태의 다중큐
        - 여러개의 프로세스 제어블록을 동시에 꺼내어 준비상태로 옮김
        - 이 작업을 위해 인터럽트 벡터를 사용함
